<div class="row">
  <div class="col-md-6 col-lg-4 col-xl-3">
    <!-- Table Filters -->
    <bp-search
      (search)="search($event)"
      (clearSearch)="clearSearch()"
    ></bp-search>
  </div>
  <ng-content select="[table-filters]"></ng-content>
</div>
<div class="table-responsive">
  <table
    class="table"
    [ngClass]="densityClass"
    [class.table-selectable-rows]="properties.hasSelectableRows"
  >
    <caption class="sr-only">{{ properties.caption }}</caption>
    <!-- Table Headings -->
    <thead>
      <tr>
        <ng-container *ngIf="properties.columns">
          <th *ngIf="properties.hasSelectableRows" class="th-selectable">
            <input
              type="checkbox"
              id="selectAllRows"
              #selectAllRowsRef
              (change)="onSelectAllRows($event)"
            />
            <label for="selectAllRows" class="sr-only">{{ properties.internationalization['Select all rows'] }}</label>
          </th>
          <ng-container *ngFor="let column of properties.columns; let i = index">
            <th
              *ngIf="column.isSortable; else columnNotSortable"
              class="th-sortable"
              scope="col"
              [hidden]="!column.isColumnDisplayed"
              [attr.aria-sort]="isSortActive ? getAriaSortOrder(i) : 'null'"
            >
              <button (click)="applySort(column.key, i)">
                {{ column.headerText }}
              </button>
            </th>
            <ng-template #columnNotSortable>
              <th
                scope="col"
                class="th-not-sortable"
              >
                {{ column.headerText }}
              </th>
            </ng-template>
          </ng-container>
          <ng-container *ngIf="properties.actions">
            <th
              *ngIf="properties.actions.length < 3"
              scope="col"
              class="th-not-sortable"
            >
              {{ properties.internationalization['Actions'] }}
            </th>
            <th
              *ngIf="properties.actions.length >= 3"
              scope="col"
              class="th-not-sortable more-actions"
            >
              <span class="sr-only">
                {{ properties.internationalization['Actions'] }}
              </span>
            </th>
          </ng-container>
        </ng-container>
      </tr>
    </thead>

    <!-- Table Loading -->
    <tbody *ngIf="isDataLoading; else loaded">
      <tr class="table-empty">
        <td colspan="100%">
          <i class="fa fa-spinner fa-spin icon-left" aria-hidden="true"></i>
          {{ properties.internationalization['Loading data'] }}
        </td>
      </tr>
    </tbody>

    <!-- Table Loaded -->
    <ng-template #loaded>
      <tbody
        table-body
        *ngIf="tableData.length > 0; else noColumnData"
        [tableData]="tableData"
        [properties]="properties"
        [pageData]="pageData"
        (action)="emitAction($event)"
        (selectedRowsAction)="onSelectRow($event)"
      ></tbody>
    </ng-template>

    <!-- Table Empty -->
    <ng-template #noColumnData>
      <tbody>
        <tr class="table-empty">
          <td colspan="100%">
            {{ properties.internationalization['No data'] }}
          </td>
        </tr>
      </tbody>
    </ng-template>
  </table>
</div>

<!-- Table Footer -->
<app-table-footer
  *ngIf="totalRecords"
  class="row justify-content-center justify-content-xl-start align-items-center mb-3"
  [totalRecords]="properties.internationalization['Total Records']"
  [defaultNumberOfRows]="defaultNumberOfRows"
  [pageBuffer]="pageBuffer"
  [pageNumber]="currentPage"
  [showColumnSelector]="properties.hasColumnSelector"
  [columnInfo]="properties.columns"
  [defaultSortColumnName]="properties.sort.defaultSortedColumn"
  (pageData)="paginate($event)"
  (displayDensityEmitter)="setDisplayDensity($event)"
  [showDisplayDensity]="properties.hasDisplayDensity"
  [displayDensity]="properties.internationalization['Display Density']"
  [columnSelectorText]="properties.internationalization['Column Selector']"
  [defaultText]="properties.internationalization['Default']"
  [rowCount]="properties.internationalization['Number of Rows']"
  [firstPage]="properties.internationalization['First Page']"
  [previousPage]="properties.internationalization['Previous Page']"
  [nextPage]="properties.internationalization['Next Page']"
  [lastPage]="properties.internationalization['Last Page']"
  [showDisplayDensityOptions]="properties.internationalization['displayDensityOptions']"
  [showNumberOfRowsOptions]="properties.internationalization['numberOfRowsOptions']"
></app-table-footer>
